// ========================================
// Common Typos Dictionary - 빈번한 오타 사전
// ========================================

/**
 * 빈번한 오타/띄어쓰기 오류 → 교정
 * 규칙 기반보다 우선 적용
 */
export const commonTypos: Record<string, string> = {
  // === 띄어쓰기 오류 (의존명사) ===
  할수있다: '할 수 있다',
  할수없다: '할 수 없다',
  할수있는: '할 수 있는',
  할수있게: '할 수 있게',
  할수있어: '할 수 있어',
  할수있을: '할 수 있을',
  할수있으면: '할 수 있으면',
  갈수있다: '갈 수 있다',
  볼수있다: '볼 수 있다',
  먹을수있다: '먹을 수 있다',

  // === 띄어쓰기 오류 (보조용언 -고 있다) ===
  하고있다: '하고 있다',
  하고있는: '하고 있는',
  하고있어: '하고 있어',
  하고있었다: '하고 있었다',
  먹고있다: '먹고 있다',
  보고있다: '보고 있다',
  가고있다: '가고 있다',
  오고있다: '오고 있다',
  살고있다: '살고 있다',

  // === 띄어쓰기 오류 (보조용언 -고 싶다) ===
  가고싶다: '가고 싶다',
  하고싶다: '하고 싶다',
  먹고싶다: '먹고 싶다',
  보고싶다: '보고 싶다',
  알고싶다: '알고 싶다',
  듣고싶다: '듣고 싶다',

  // === 띄어쓰기 오류 (보조용언 -지 않다/못하다) ===
  하지않다: '하지 않다',
  가지않다: '가지 않다',
  먹지않다: '먹지 않다',
  보지않다: '보지 않다',
  오지않다: '오지 않다',
  하지않는다: '하지 않는다',
  하지않았다: '하지 않았다',
  하지못하다: '하지 못하다',
  가지못하다: '가지 못하다',

  // === 띄어쓰기 오류 (의존명사 것/거) ===
  하는것: '하는 것',
  먹는것: '먹는 것',
  가는것: '가는 것',
  보는것: '보는 것',
  할것: '할 것',
  먹을것: '먹을 것',
  갈것: '갈 것',
  볼것: '볼 것',
  한것: '한 것',
  먹은것: '먹은 것',
  할거야: '할 거야',
  갈거야: '갈 거야',
  먹을거야: '먹을 거야',

  // === 띄어쓰기 오류 (의존명사 때) ===
  할때: '할 때',
  갈때: '갈 때',
  먹을때: '먹을 때',
  볼때: '볼 때',
  올때: '올 때',
  했을때: '했을 때',
  왔을때: '왔을 때',

  // === 띄어쓰기 오류 (의존명사 줄) ===
  할줄: '할 줄',
  알줄: '알 줄',
  모를줄: '모를 줄',

  // === 띄어쓰기 오류 (기타 의존명사) ===
  할뿐: '할 뿐',
  뿐만아니라: '뿐만 아니라',
  할만큼: '할 만큼',
  하는대로: '하는 대로',
  가는데: '가는 데',
  하는데: '하는 데',
  온지: '온 지',
  간지: '간 지',

  // === 띄어쓰기 오류 (해야 한다) ===
  해야한다: '해야 한다',
  가야한다: '가야 한다',
  먹어야한다: '먹어야 한다',
  봐야한다: '봐야 한다',
  알아야한다: '알아야 한다',

  // === 발음 혼동 (되/돼) ===
  되요: '돼요',
  되서: '돼서',
  됬다: '됐다',
  됬어: '됐어',
  됬는데: '됐는데',
  안되요: '안돼요',
  안되서: '안돼서',
  못되요: '못돼요',

  // === 발음 혼동 (않/안) ===
  않해: '안 해',
  않된다: '안 된다',
  않돼: '안 돼',
  않가: '안 가',
  않먹어: '안 먹어',

  // === 발음 혼동 (기타) ===
  몰겠다: '모르겠다',
  모르겟다: '모르겠다',
  같애: '같아',
  어떻게해: '어떻게 해',
  어떻게하면: '어떻게 하면',

  // === 받침 실수 ===
  먹엇다: '먹었다',
  갔엇다: '갔었다',
  했엇다: '했었다',
  봤엇다: '봤었다',
  왔엇다: '왔었다',
  읽엇다: '읽었다',
  없엇다: '없었다',
  있엇다: '있었다',

  // === 자주 틀리는 단어 ===
  웬지: '왠지',
  왠일: '웬일',
  몇일: '며칠',
  설레임: '설렘',
  어의없다: '어이없다',
  의외로: '의외로', // 맞음
  어떻게: '어떻게', // 맞음
  어떻게든: '어떻게든', // 맞음
};

/**
 * 혼동하기 쉬운 단어 쌍
 */
export const confusablePairs: { pair: [string, string]; rule: string }[] = [
  { pair: ['되', '돼'], rule: '"하여"로 바꿔서 자연스러우면 "돼"' },
  { pair: ['로서', '로써'], rule: '자격=로서, 수단/도구=로써' },
  { pair: ['로', '으로'], rule: '받침 없음=로, 받침 있음(ㄹ제외)=으로' },
  { pair: ['든지', '던지'], rule: '선택/나열=든지, 과거회상=던지' },
  { pair: ['데', '대'], rule: '장소/상황=데, 말하기/인용=대' },
  { pair: ['애', '에'], rule: '표준어 발음 구분 필요' },
  { pair: ['왠', '웬'], rule: '왠지(왜인지), 웬(어찌된/어떤)' },
  { pair: ['낫다', '낳다'], rule: '비교=낫다, 출산=낳다' },
  { pair: ['맞추다', '맞히다'], rule: '조절/조합=맞추다, 적중=맞히다' },
  { pair: ['붙이다', '부치다'], rule: '접착=붙이다, 전송/부침개=부치다' },
];

/**
 * 빈번한 오타인지 확인
 */
export function isCommonTypo(word: string): boolean {
  return word in commonTypos;
}

/**
 * 빈번한 오타 교정
 */
export function correctCommonTypo(word: string): string | null {
  return commonTypos[word] || null;
}

/**
 * 텍스트에서 빈번한 오타 모두 교정
 */
export function correctAllCommonTypos(text: string): {
  corrected: string;
  corrections: { original: string; corrected: string }[];
} {
  let result = text;
  const corrections: { original: string; corrected: string }[] = [];

  // 긴 패턴부터 매칭 (greedy)
  const sortedTypos = Object.entries(commonTypos).sort(([a], [b]) => b.length - a.length);

  for (const [typo, correct] of sortedTypos) {
    if (result.includes(typo)) {
      corrections.push({ original: typo, corrected: correct });
      result = result.split(typo).join(correct);
    }
  }

  return { corrected: result, corrections };
}
